<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AP-02 | CAPM + SDF Foundations</title>
  <meta name="description" content="AP-02 module: CAPM derivations, SDF foundations, and qualifier-style problems.">
  <link rel="stylesheet" href="../assets/styles.css">
  <script defer src="../assets/app.js"></script>
</head>
<body data-mode="learn">
  <div class="progress-track"><div class="progress-bar"></div></div>

  <header class="nav">
    <div class="container">
      <div class="brand">
        <span class="brand-mark" aria-hidden="true"></span>
        <span>AP-02 Module</span>
      </div>
      <nav class="nav-links">
        <a href="index.html">Asset Pricing Track</a>
        <a href="#flight-plan">Flight Plan</a>
        <a href="#walkthrough">Walkthrough</a>
        <a href="#problems">Problem Bank</a>
        <a href="#deck">Slide Deck</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero container" id="overview">
      <div class="hero-copy reveal">
        <span class="eyebrow">AP-02: CAPM + SDF Foundations</span>
        <h1>Derive the CAPM Twice</h1>
        <p>
          This module is about ownership. You will derive CAPM from mean-variance logic, then
          re-derive it from the pricing kernel. Same equation, two viewpoints, one story.
        </p>
        <div class="action-bar">
          <div class="toggle-group" role="group" aria-label="Study mode">
            <button class="toggle-button" data-mode-toggle="learn">Learn Mode</button>
            <button class="toggle-button" data-mode-toggle="exam">Exam Mode</button>
          </div>
          <a class="button" href="AP_02_CAPM_SDF_Foundations.pdf">Download slides (PDF)</a>
        </div>
      </div>
      <div class="hero-panel reveal" data-delay="140">
        <div class="signal-grid">
          <div class="signal-card">
            <div class="signal-title">Core Equation</div>
            <h3>E[R_i] - R_f = beta_i (E[R_M] - R_f)</h3>
            <p>We walk into this result, then walk out with it again via SDF.</p>
          </div>
          <div class="signal-card">
            <div class="signal-title">SDF Bridge</div>
            <h3>E[m R_i] = 1</h3>
            <p>One pricing equation that explains every asset on the sheet.</p>
          </div>
          <div class="signal-card">
            <div class="signal-title">Exam Anchor</div>
            <h3>Covariance is the price</h3>
            <p>No covariance with the market, no risk premium. Period.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="flight-plan" class="section container">
      <h2 class="reveal">Flight Plan</h2>
      <p class="section-intro reveal" data-delay="120">
        If you can execute this cleanly, you can answer any CAPM qualifier question I have seen.
      </p>
      <div class="checklist reveal" data-delay="180" data-checklist="ap02-core">
        <label class="checklist-item">
          <input type="checkbox">
          <span><strong>Write the mean-variance FOC.</strong> Show
            \(\mu - R_f \mathbf{1} - \gamma \Sigma w = 0\).</span>
        </label>
        <label class="checklist-item">
          <input type="checkbox">
          <span><strong>Identify the market portfolio.</strong> Argue the market is the tangency portfolio.</span>
        </label>
        <label class="checklist-item">
          <input type="checkbox">
          <span><strong>Convert to covariance form.</strong> Use
            \((\Sigma w_M)_i = \Cov(R_i, R_M)\).</span>
        </label>
        <label class="checklist-item">
          <input type="checkbox">
          <span><strong>Pin down the slope.</strong> Apply the equation to \(R_M\) and solve for beta.</span>
        </label>
        <label class="checklist-item">
          <input type="checkbox">
          <span><strong>Repeat with the SDF.</strong> Use \(\E[mR_i]=1\) and linear \(m\).</span>
        </label>
        <div class="checklist-footer">
          <button type="button" data-checklist-reset>Reset</button>
          <span class="checklist-progress" data-checklist-progress></span>
        </div>
      </div>
    </section>

    <section class="section container">
      <h2 class="reveal">Core Equations You Must Own</h2>
      <p class="section-intro reveal" data-delay="120">
        Put these on your scratch paper without thinking. That is the standard.
      </p>
      <div class="resource-grid">
        <article class="resource-card reveal" data-delay="160">
          <h4>CAPM</h4>
          <p class="math-block">\(\E[R_i] - R_f = \beta_i(\E[R_M]-R_f)\)</p>
        </article>
        <article class="resource-card reveal" data-delay="210">
          <h4>SDF Pricing</h4>
          <p class="math-block">\(\E[m R_i] = 1\)</p>
        </article>
      </div>
    </section>

    <section id="walkthrough" class="section container">
      <h2 class="reveal">Live Walkthrough</h2>
      <p class="section-intro reveal" data-delay="120">
        Learn Mode gives full narration. Exam Mode removes the commentary so you can rehearse.
      </p>
      <div class="stepper reveal" data-stepper data-delay="180">
        <div class="stepper-panels">
          <div class="stepper-panel" data-step="1">
            <h4>1. Mean-variance objective</h4>
            <p class="mode-detail">Write \(\max_w \E[R_p] - \tfrac{\gamma}{2}\Var(R_p)\) with a risk-free asset.</p>
            <p class="mode-summary">State objective and definitions.</p>
            <div class="math-block">\(\E[R_p] = R_f + w'(\mu - R_f \mathbf{1})\)</div>
          </div>
          <div class="stepper-panel" data-step="2">
            <h4>2. First-order condition</h4>
            <p class="mode-detail">Differentiate: \(\mu - R_f \mathbf{1} - \gamma \Sigma w = 0\).</p>
            <p class="mode-summary">Solve FOC for w.</p>
            <div class="math-block">\(w \propto \Sigma^{-1}(\mu - R_f \mathbf{1})\)</div>
          </div>
          <div class="stepper-panel" data-step="3">
            <h4>3. Market portfolio</h4>
            <p class="mode-detail">Market clearing implies the market portfolio is the tangency portfolio.</p>
            <p class="mode-summary">Argue efficiency of market portfolio.</p>
            <div class="math-block">\(\Sigma w_M = \kappa(\mu - R_f \mathbf{1})\)</div>
          </div>
          <div class="stepper-panel" data-step="4">
            <h4>4. Covariance identity</h4>
            <p class="mode-detail">Use \((\Sigma w_M)_i = \Cov(R_i, R_M)\) to connect to beta.</p>
            <p class="mode-summary">Translate matrix equation to covariance form.</p>
          </div>
          <div class="stepper-panel" data-step="5">
            <h4>5. Solve for the slope</h4>
            <p class="mode-detail">Apply the same equation to the market to identify \(\kappa\), then substitute.</p>
            <p class="mode-summary">Solve for CAPM beta form.</p>
          </div>
          <div class="stepper-panel" data-step="6">
            <h4>6. SDF bridge</h4>
            <p class="mode-detail">Start from \(\E[m R_i] = 1\). Assume \(m = a - b R_M\).</p>
            <p class="mode-summary">Write pricing equation and linear SDF.</p>
            <div class="math-block">\(\E[R_i] - R_f = -\frac{\Cov(m, R_i)}{\E[m]}\)</div>
          </div>
          <div class="stepper-panel" data-step="7">
            <h4>7. Recover CAPM</h4>
            <p class="mode-detail">Substitute \(\Cov(m, R_i) = -b\Cov(R_M, R_i)\) and divide by the market case.</p>
            <p class="mode-summary">Show the same CAPM equation falls out.</p>
          </div>
        </div>
        <div class="stepper-controls">
          <button type="button" data-stepper-action="prev">Back</button>
          <button type="button" data-stepper-action="next">Next</button>
          <span class="stepper-index" data-stepper-index></span>
        </div>
      </div>
    </section>

    <section class="section container">
      <h2 class="reveal">Exam Timer</h2>
      <p class="section-intro reveal" data-delay="120">
        Write the full CAPM derivation in one pass. Use this timer to simulate the exam.
      </p>
      <div class="timer reveal" data-delay="180" data-timer data-timer-minutes="20">
        <div class="timer-display" data-timer-display></div>
        <div class="timer-controls">
          <button type="button" data-timer-action="start">Start</button>
          <button type="button" data-timer-action="pause">Pause</button>
          <button type="button" data-timer-action="reset">Reset</button>
          <label>Minutes
            <input type="number" min="5" max="60" value="20" data-timer-input>
          </label>
        </div>
      </div>
    </section>

    <section class="section container">
      <h2 class="reveal">CAPM Calculator</h2>
      <p class="section-intro reveal" data-delay="120">
        Use this to sanity-check betas and implied expected returns.
      </p>
      <div class="method-card reveal" data-delay="180" data-calc="capm">
        <div class="calc-grid">
          <label>Risk-free \(R_f\)
            <input type="number" name="rf" step="0.001" value="1.02">
          </label>
          <label>Market mean \(\E[R_M]\)
            <input type="number" name="muM" step="0.001" value="1.10">
          </label>
          <label>Market variance \(\Var(R_M)\)
            <input type="number" name="varM" step="0.001" value="0.04">
          </label>
          <label>Covariance \(\Cov(R_i,R_M)\)
            <input type="number" name="cov" step="0.001" value="0.06">
          </label>
        </div>
        <div class="calc-output" data-calc-output></div>
      </div>
    </section>

    <section id="problems" class="section container">
      <h2 class="reveal">Problem Walkthroughs</h2>
      <p class="section-intro reveal" data-delay="120">
        Expand to see the full qualifier logic, from setup to interpretation.
      </p>
      <div class="accordion reveal" data-delay="160">
        <div class="accordion-item">
          <button class="accordion-button" data-accordion-toggle aria-expanded="false">
            Problem A: Full CAPM derivation <span data-accordion-icon>+</span>
          </button>
          <div class="accordion-panel">
            <p>Write the mean-variance objective, solve the FOC, identify the tangency portfolio,
              and use market clearing to get \(\Sigma w_M = \kappa(\mu - R_f \mathbf{1})\).
              Convert to covariance form and solve for \(\kappa\).</p>
          </div>
        </div>
        <div class="accordion-item">
          <button class="accordion-button" data-accordion-toggle aria-expanded="false">
            Problem B: CAPM from an SDF <span data-accordion-icon>+</span>
          </button>
          <div class="accordion-panel">
            <p>Start from \(\E[mR_i]=1\). Use covariance decomposition to isolate \(\E[R_i]-R_f\),
              substitute a linear SDF, and divide by the market equation to recover CAPM.</p>
          </div>
        </div>
        <div class="accordion-item">
          <button class="accordion-button" data-accordion-toggle aria-expanded="false">
            Problem C: Zero-beta CAPM <span data-accordion-icon>+</span>
          </button>
          <div class="accordion-panel">
            <p>No risk-free asset? Derive \(\E[R_i] = \E[R_Z] + \beta_i^Z(\E[R_M]-\E[R_Z])\),
              then interpret \(R_Z\) as the return on the minimum variance portfolio orthogonal to the market.</p>
          </div>
        </div>
        <div class="accordion-item">
          <button class="accordion-button" data-accordion-toggle aria-expanded="false">
            Problem D: Factor model nesting <span data-accordion-icon>+</span>
          </button>
          <div class="accordion-panel">
            <p>Show how the CAPM is the one-factor case of \(\E[R_i] = R_f + \beta_i'\lambda\).
              Explain what it means to test the CAPM inside a multi-factor model.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section container">
      <h2 class="reveal">Drill Generator</h2>
      <p class="section-intro reveal" data-delay="120">
        Draw a fresh qualifier prompt on demand. Ideal for rapid rehearsal.
      </p>
      <div class="method-card reveal" data-delay="180" data-drill-bank="ap02-drills">
        <button class="button secondary" type="button" data-drill-button>New Drill</button>
        <div class="drill-card" data-drill-output></div>
      </div>
    </section>

    <section id="deck" class="section container">
      <h2 class="reveal">Full Slide Deck</h2>
      <p class="section-intro reveal" data-delay="120">
        The live deck is embedded below. Download the PDF if you want to annotate offline.
      </p>
      <div class="viewer reveal" data-delay="180">
        <iframe class="pdf-viewer" title="AP-02 slide deck" loading="lazy"
          src="AP_02_CAPM_SDF_Foundations.pdf#view=FitH"></iframe>
      </div>
    </section>

    <section class="section container">
      <h2 class="reveal">Instructor Voice</h2>
      <p class="section-intro reveal" data-delay="120">
        I am an independent researcher and PhD (Georgia Institute of Technology), not currently affiliated
        with an institution. These materials are my own and are written to feel like a personal
        whiteboard session.
      </p>
    </section>

    <footer class="footer">
      <div class="container footer-grid">
        <div>
          <h4>AP-02 Module</h4>
          <p>CAPM and SDF foundations for qualifier-level mastery.</p>
        </div>
        <div>
          <h4>Back to Track</h4>
          <p><a href="index.html">Return to Empirical Asset Pricing</a></p>
        </div>
        <div>
          <h4>Instructor</h4>
          <p>Dr. Ian Helfrich, independent researcher.</p>
        </div>
      </div>
    </footer>
  </main>

  <script type="application/json" id="ap02-drills">
    [
      {
        "title": "Drill 1: Beta from covariance",
        "prompt": "Given Var(R_M) and Cov(R_i,R_M), compute beta and expected return.",
        "tags": ["beta", "covariance", "CAPM"]
      },
      {
        "title": "Drill 2: Derive CAPM from mean-variance",
        "prompt": "Write the FOC, link the market portfolio, and identify the slope using the market itself.",
        "tags": ["mean-variance", "market clearing"]
      },
      {
        "title": "Drill 3: SDF derivation",
        "prompt": "Assume m = a - b R_M. Use E[mR]=1 to recover the CAPM in two lines.",
        "tags": ["SDF", "no-arbitrage"]
      }
    ]
  </script>

  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)']], displayMath: [['\\[', '\\]']] }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
